"use strict";(self.webpackChunkkims_frontend=self.webpackChunkkims_frontend||[]).push([[754],{1108:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(5043),l=s(249),o=s(579);class n extends a.Component{constructor(e){super(e),this.handleChange=e=>{this.setState({selectedValue:e}),this.props.onUpdateSelectedValue(e)},this.state={selectedValue:this.props.selectedValue||(this.props.isMulti?[]:"")}}componentDidUpdate(e){e.selectedValue!==this.props.selectedValue&&this.setState({selectedValue:this.props.selectedValue||(this.props.isMulti?[]:"")})}render(){const{selectedValue:e}=this.state,{data:t,placeholder:s,width:a,placeholderColor:n,menuPlacement:r,isMulti:i}=this.props;return(0,o.jsx)("div",{className:"DropDownList m-1 "+(a?`w-${a}`:""),children:(0,o.jsx)(l.Ay,{className:"dropdown",placeholder:s,value:e,options:t,onChange:this.handleChange,isMulti:i,isClearable:!0,styles:{control:e=>({...e,cursor:"pointer"}),placeholder:e=>({...e,color:n||"#6c757d"}),menu:e=>({...e,overflow:"hidden"}),menuList:e=>({...e,maxHeight:200,overflowY:"auto"})},menuPlacement:r||"auto"})})}}const r=n},4754:(e,t,s)=>{s.r(t),s.d(t,{default:()=>oe});var a=s(5043),l=s(1036),o=s(1457),n=s(8087),r=s(4282),i=s(579);class c extends a.Component{render(){const{show:e,onHide:t,onDelete:s,item:a}=this.props;return(0,i.jsxs)(n.A,{show:e,onHide:t,children:[(0,i.jsx)(n.A.Header,{closeButton:!0,children:(0,i.jsx)(n.A.Title,{children:"Delete Item"})}),(0,i.jsx)(n.A.Body,{children:(0,i.jsxs)("p",{children:["Are you sure you want to delete the Item ",(0,i.jsx)("strong",{children:null===a||void 0===a?void 0:a.itemname}),"?"]})}),(0,i.jsxs)(n.A.Footer,{children:[(0,i.jsx)(r.A,{variant:"secondary",onClick:t,children:"Cancel"}),(0,i.jsx)(r.A,{variant:"danger",onClick:s,children:"Delete"})]})]})}}class d extends a.Component{constructor(e){super(e),this.openDeleteModal=()=>{this.setState({showDeleteModal:!0})},this.closeDeleteModal=()=>{this.setState({showDeleteModal:!1})},this.handleDelete=async()=>{const{item:e,fetchItems:t}=this.props;try{await o.A.deleteItem(e.id),l.oR.success(`UOM ${e.itemname} deleted successfully`),this.closeDeleteModal(),t()}catch(s){s.response&&s.response.data.error.includes("violates foreign key constraint")?(this.closeDeleteModal(),l.oR.error("Item cannot be deleted as it is connected to others.")):l.oR.error("Failed to delete Item"),console.error(s)}},this.state={showDeleteModal:!1}}render(){const{showDeleteModal:e}=this.state,{item:t}=this.props;return(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{role:"button",className:"btn btn-danger ",title:"Delete Item",onClick:this.openDeleteModal,children:(0,i.jsx)("i",{className:"bi bi-trash-fill"})}),(0,i.jsx)(c,{show:e,onHide:this.closeDeleteModal,onDelete:this.handleDelete,item:t})]})}}var m=s(8139),h=s.n(m),p=s(5173),u=s.n(p);const x={type:u().string,tooltip:u().bool,as:u().elementType},f=a.forwardRef(((e,t)=>{let{as:s="div",className:a,type:l="valid",tooltip:o=!1,...n}=e;return(0,i.jsx)(s,{...n,ref:t,className:h()(a,`${l}-${o?"tooltip":"feedback"}`)})}));f.displayName="Feedback",f.propTypes=x;const j=f,b=a.createContext({});var v=s(7852);const N=a.forwardRef(((e,t)=>{let{id:s,bsPrefix:l,className:o,type:n="checkbox",isValid:r=!1,isInvalid:c=!1,as:d="input",...m}=e;const{controlId:p}=(0,a.useContext)(b);return l=(0,v.oU)(l,"form-check-input"),(0,i.jsx)(d,{...m,ref:t,type:n,id:s||p,className:h()(o,l,r&&"is-valid",c&&"is-invalid")})}));N.displayName="FormCheckInput";const g=N,I=a.forwardRef(((e,t)=>{let{bsPrefix:s,className:l,htmlFor:o,...n}=e;const{controlId:r}=(0,a.useContext)(b);return s=(0,v.oU)(s,"form-check-label"),(0,i.jsx)("label",{...n,ref:t,htmlFor:o||r,className:h()(l,s)})}));I.displayName="FormCheckLabel";const y=I;const C=a.forwardRef(((e,t)=>{let{id:s,bsPrefix:l,bsSwitchPrefix:o,inline:n=!1,reverse:r=!1,disabled:c=!1,isValid:d=!1,isInvalid:m=!1,feedbackTooltip:p=!1,feedback:u,feedbackType:x,className:f,style:N,title:I="",type:C="checkbox",label:w,children:U,as:A="input",...M}=e;l=(0,v.oU)(l,"form-check"),o=(0,v.oU)(o,"form-switch");const{controlId:S}=(0,a.useContext)(b),F=(0,a.useMemo)((()=>({controlId:s||S})),[S,s]),k=!U&&null!=w&&!1!==w||function(e,t){return a.Children.toArray(e).some((e=>a.isValidElement(e)&&e.type===t))}(U,y),V=(0,i.jsx)(g,{...M,type:"switch"===C?"checkbox":C,ref:t,isValid:d,isInvalid:m,disabled:c,as:A});return(0,i.jsx)(b.Provider,{value:F,children:(0,i.jsx)("div",{style:N,className:h()(f,k&&l,n&&`${l}-inline`,r&&`${l}-reverse`,"switch"===C&&o),children:U||(0,i.jsxs)(i.Fragment,{children:[V,k&&(0,i.jsx)(y,{title:I,children:w}),u&&(0,i.jsx)(j,{type:x,tooltip:p,children:u})]})})})}));C.displayName="FormCheck";const w=Object.assign(C,{Input:g,Label:y});s(6440);const U=a.forwardRef(((e,t)=>{let{bsPrefix:s,type:l,size:o,htmlSize:n,id:r,className:c,isValid:d=!1,isInvalid:m=!1,plaintext:p,readOnly:u,as:x="input",...f}=e;const{controlId:j}=(0,a.useContext)(b);return s=(0,v.oU)(s,"form-control"),(0,i.jsx)(x,{...f,type:l,size:n,ref:t,readOnly:u,id:r||j,className:h()(c,p?`${s}-plaintext`:s,o&&`${s}-${o}`,"color"===l&&`${s}-color`,d&&"is-valid",m&&"is-invalid")})}));U.displayName="FormControl";const A=Object.assign(U,{Feedback:j}),M=a.forwardRef(((e,t)=>{let{className:s,bsPrefix:a,as:l="div",...o}=e;return a=(0,v.oU)(a,"form-floating"),(0,i.jsx)(l,{ref:t,className:h()(s,a),...o})}));M.displayName="FormFloating";const S=M,F=a.forwardRef(((e,t)=>{let{controlId:s,as:l="div",...o}=e;const n=(0,a.useMemo)((()=>({controlId:s})),[s]);return(0,i.jsx)(b.Provider,{value:n,children:(0,i.jsx)(l,{...o,ref:t})})}));F.displayName="FormGroup";const k=F;const V=a.forwardRef(((e,t)=>{const[{className:s,...a},{as:l="div",bsPrefix:o,spans:n}]=function(e){let{as:t,bsPrefix:s,className:a,...l}=e;s=(0,v.oU)(s,"col");const o=(0,v.gy)(),n=(0,v.Jm)(),r=[],i=[];return o.forEach((e=>{const t=l[e];let a,o,c;delete l[e],"object"===typeof t&&null!=t?({span:a,offset:o,order:c}=t):a=t;const d=e!==n?`-${e}`:"";a&&r.push(!0===a?`${s}${d}`:`${s}${d}-${a}`),null!=c&&i.push(`order${d}-${c}`),null!=o&&i.push(`offset${d}-${o}`)})),[{...l,className:h()(a,...r,...i)},{as:t,bsPrefix:s,spans:r}]}(e);return(0,i.jsx)(l,{...a,ref:t,className:h()(s,!n.length&&o)})}));V.displayName="Col";const $=V,D=a.forwardRef(((e,t)=>{let{as:s="label",bsPrefix:l,column:o=!1,visuallyHidden:n=!1,className:r,htmlFor:c,...d}=e;const{controlId:m}=(0,a.useContext)(b);l=(0,v.oU)(l,"form-label");let p="col-form-label";"string"===typeof o&&(p=`${p} ${p}-${o}`);const u=h()(r,l,n&&"visually-hidden",o&&p);return c=c||m,o?(0,i.jsx)($,{ref:t,as:"label",className:u,htmlFor:c,...d}):(0,i.jsx)(s,{ref:t,className:u,htmlFor:c,...d})}));D.displayName="FormLabel";const R=D,P=a.forwardRef(((e,t)=>{let{bsPrefix:s,className:l,id:o,...n}=e;const{controlId:r}=(0,a.useContext)(b);return s=(0,v.oU)(s,"form-range"),(0,i.jsx)("input",{...n,type:"range",ref:t,className:h()(l,s),id:o||r})}));P.displayName="FormRange";const L=P,T=a.forwardRef(((e,t)=>{let{bsPrefix:s,size:l,htmlSize:o,className:n,isValid:r=!1,isInvalid:c=!1,id:d,...m}=e;const{controlId:p}=(0,a.useContext)(b);return s=(0,v.oU)(s,"form-select"),(0,i.jsx)("select",{...m,size:o,ref:t,className:h()(n,s,l&&`${s}-${l}`,r&&"is-valid",c&&"is-invalid"),id:d||p})}));T.displayName="FormSelect";const H=T,O=a.forwardRef(((e,t)=>{let{bsPrefix:s,className:a,as:l="small",muted:o,...n}=e;return s=(0,v.oU)(s,"form-text"),(0,i.jsx)(l,{...n,ref:t,className:h()(a,s,o&&"text-muted")})}));O.displayName="FormText";const E=O,B=a.forwardRef(((e,t)=>(0,i.jsx)(w,{...e,ref:t,type:"switch"})));B.displayName="Switch";const z=Object.assign(B,{Input:w.Input,Label:w.Label}),G=a.forwardRef(((e,t)=>{let{bsPrefix:s,className:a,children:l,controlId:o,label:n,...r}=e;return s=(0,v.oU)(s,"form-floating"),(0,i.jsxs)(k,{ref:t,className:h()(a,s),controlId:o,...r,children:[l,(0,i.jsx)("label",{htmlFor:o,children:n})]})}));G.displayName="FloatingLabel";const _=G,q={_ref:u().any,validated:u().bool,as:u().elementType},J=a.forwardRef(((e,t)=>{let{className:s,validated:a,as:l="form",...o}=e;return(0,i.jsx)(l,{...o,ref:t,className:h()(s,a&&"was-validated")})}));J.displayName="Form",J.propTypes=q;const Y=Object.assign(J,{Group:k,Control:A,Floating:S,Check:w,Switch:z,Label:R,Text:E,Range:L,Select:H,FloatingLabel:_});var K=s(1108);class Q extends a.Component{constructor(e){super(e),this.loadItemData=()=>{const{item:e,uoms:t}=this.props;if(e&&t.length>0){const s=t.find((t=>t.id===e.uomid));this.setState({itemname:e.itemname||"",selectedUom:s?{value:s.id,label:s.uomname}:null,threshold:e.threshold||"",uoms:t.map((e=>({value:e.id,label:e.uomname})))})}},this.handleInputChange=e=>{this.setState({[e.target.name]:e.target.value})},this.handleUomChange=e=>{console.log("Selected UOM:",e),this.setState({selectedUom:e})},this.handleUpdate=async()=>{const{fetchItems:e,item:t,onHide:s}=this.props,{itemname:a,selectedUom:n,threshold:r}=this.state;if(!a.trim()||!n)return void l.oR.error("Item Name and UOM are required.");const i={itemname:a.trim(),uomid:n.value,threshold:r};try{await o.A.updateItem(t.id,i),e(),l.oR.success("Item updated successfully"),s()}catch(c){l.oR.error("Failed to update item.")}},this.state={itemname:"",selectedUom:null,threshold:"",uoms:[]}}componentDidMount(){this.loadItemData()}componentDidUpdate(e){e.item===this.props.item&&e.uoms===this.props.uoms||this.loadItemData()}render(){const{show:e,onHide:t}=this.props,{itemname:s,selectedUom:a,threshold:l,uoms:o}=this.state;return(0,i.jsxs)(n.A,{show:e,onHide:t,centered:!0,children:[(0,i.jsx)(n.A.Header,{closeButton:!0,children:(0,i.jsx)(n.A.Title,{children:"Update Item"})}),(0,i.jsx)(n.A.Body,{children:(0,i.jsxs)(Y,{children:[(0,i.jsxs)(Y.Group,{children:[(0,i.jsx)(Y.Label,{children:"Item Name"}),(0,i.jsx)(Y.Control,{type:"text",name:"itemname",value:s,onChange:this.handleInputChange,placeholder:"Enter item name"})]}),(0,i.jsxs)(Y.Group,{children:[(0,i.jsx)(Y.Label,{children:"Threshold"}),(0,i.jsx)(Y.Control,{type:"number",name:"threshold",value:l,onChange:this.handleInputChange,placeholder:"Enter threshold value"})]}),(0,i.jsxs)(Y.Group,{children:[(0,i.jsx)(Y.Label,{children:"UOM"}),(0,i.jsx)(K.A,{name:"selectedUom",placeholder:"Select UOM",data:o,onUpdateSelectedValue:this.handleUomChange,selectedValue:a})]})]})}),(0,i.jsxs)(n.A.Footer,{children:[(0,i.jsx)(r.A,{variant:"secondary",onClick:t,children:"Cancel"}),(0,i.jsx)(r.A,{variant:"primary",onClick:this.handleUpdate,children:"Update Item"})]})]})}}const W=Q;class X extends a.Component{constructor(e){super(e),this.openUpdateItemModal=()=>{this.setState({showUpdateItemModal:!0})},this.closeUpdateItemModal=()=>{this.setState({showUpdateItemModal:!1})},this.state={showUpdateItemModal:!1}}render(){const{showUpdateItemModal:e}=this.state,{item:t,fetchItems:s,uoms:a}=this.props;return(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{role:"button",onClick:this.openUpdateItemModal,className:"btn btn-primary me-2",title:"Edit Item",children:(0,i.jsx)("i",{className:"bi bi-pencil-fill"})}),t&&(0,i.jsx)(W,{show:e,onHide:this.closeUpdateItemModal,item:t,uoms:a,fetchItems:s})]})}}class Z extends a.Component{render(){const{items:e,uoms:t,uomsMap:s,loading:a,fetchItems:l}=this.props;return a?(0,i.jsx)("div",{className:"w-100 text-center mt-5",children:(0,i.jsx)("div",{className:"spinner-border",role:"status",children:(0,i.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):(0,i.jsx)("div",{className:"row",children:e.length?e.map((e=>(0,i.jsx)("div",{className:"col-md-4 col-sm-6 col-12 mb-3",children:(0,i.jsx)("div",{className:"card h-100",children:(0,i.jsxs)("div",{className:"card-body",children:[(0,i.jsxs)("h5",{className:"card-title",children:["Name:",(0,i.jsxs)("span",{className:"text-grey",children:[" ",e.itemname]})]}),(0,i.jsxs)("h5",{className:"card-title",children:["Threshold:",(0,i.jsxs)("span",{className:"text-grey",children:[" ",e.threshold," ",s[e.uomid]||"Unknown UOM"]})]}),(0,i.jsx)("div",{children:(0,i.jsx)("label",{})}),(0,i.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,i.jsx)(X,{item:e,uoms:t,fetchItems:l}),(0,i.jsx)("div",{className:"me-3"}),(0,i.jsx)(d,{item:e,fetchItems:l})]})]})})},e.id))):(0,i.jsx)("div",{className:"col-12 text-center",children:"No items found"})})}}var ee=s(1938);class te extends a.Component{constructor(e){super(e),this.handleInputChange=e=>{this.setState({[e.target.name]:e.target.value})},this.handleUomChange=e=>{this.setState({selectedUom:e})},this.handleCreate=async()=>{const{fetchItems:e}=this.props,{itemname:t,threshold:s,selectedUom:a}=this.state,n={itemname:t,threshold:s,uomid:a.value};try{await o.A.createItem(n),e(),l.oR.success("Item created successfully"),this.props.onHide()}catch(r){console.log(r),l.oR.error("Failed to create Item.")}},this.state={itemname:"",threshold:"",uoms:[],selectedUom:null}}render(){const{show:e,onHide:t,uoms:s}=this.props,{itemname:a,threshold:l,selectedUom:o}=this.state;return(0,i.jsx)(n.A,{show:e,onHide:t,children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsx)("h5",{className:"modal-title",children:"Create Item"}),(0,i.jsx)("button",{type:"button",className:"btn-close",onClick:t})]}),(0,i.jsxs)("div",{className:"modal-body mb-3",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"itemname",className:"mb-2",children:"Item Name"}),(0,i.jsx)("input",{type:"text",className:"form-control",id:"itemname",name:"itemname",placeholder:"Enter Item name",value:a,onChange:this.handleInputChange})]}),(0,i.jsxs)("div",{className:"form-group mt-3",children:[(0,i.jsx)("label",{htmlFor:"threshold",className:"mb-2",children:"Threshold"}),(0,i.jsx)("input",{type:"text",className:"form-control",id:"threshold",name:"threshold",placeholder:"Enter Threshold",value:l,onChange:this.handleInputChange})]}),(0,i.jsxs)("div",{className:"form-group mt-3",children:[(0,i.jsx)("label",{htmlFor:"uom",className:"mb-2",children:"Select UOM"}),(0,i.jsx)(K.A,{name:"selectedUom",placeholder:"Select UOM",data:s.map((e=>({value:e.id,label:e.uomname}))),onUpdateSelectedValue:this.handleUomChange,selectedValue:o})]})]}),(0,i.jsxs)("div",{className:"modal-footer",children:[(0,i.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:t,children:"Cancel"}),(0,i.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.handleCreate,children:"Create Item"})]})]})})}}const se=te;class ae extends a.Component{constructor(e){super(e),this.openItemModal=()=>{this.setState({showItemModal:!0})},this.closeItemModal=()=>{this.setState({showItemModal:!1})},this.state={showItemModal:!1}}render(){const{showItemModal:e}=this.state,{fetchItems:t,uoms:s}=this.props;return(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)("button",{className:"btn btn-primary",onClick:()=>this.openItemModal(),children:"Create Item"}),(0,i.jsx)(se,{show:e,onHide:this.closeItemModal,uoms:s,fetchItems:t})]})}}var le=s(214);class oe extends a.Component{constructor(e){super(e),this.getAllItems=()=>{o.A.getAllItems().then((e=>{this.setState({items:e.data.items||[],loading:!1})})).catch((e=>{console.log(e),this.setState({loading:!1})}))},this.fetchMap=e=>e.reduce(((e,t)=>(e[t.id]=t.uomname,e)),{}),this.handleExportCSV=()=>{((e,t)=>{le.A.post("/exportcsv",e,{responseType:"blob"}).then((e=>{const s=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=s,a.setAttribute("download",t),document.body.appendChild(a),a.click()})).catch((e=>{console.error("Error exporting CSV:",e)}))})({modelName:"item",fields:["uomid","itemname"]},"items.csv")},this.handleSearchChange=e=>{this.setState({search:e.target.value})},this.handleFileChange=e=>{this.setState({csvFile:e.target.files[0]})},this.handleImportCSV=()=>{const{csvFile:e}=this.state;if(!e)return void alert("Please select a CSV file to import.");const t=new FormData;t.append("modelName","item"),t.append("file",e),o.A.importFromCSV(t).then((e=>{alert(e.data.message),this.getAllItems()})).catch((e=>{console.error("Error importing CSV:",e),alert("Error importing CSV data.")}))},this.state={items:[],uoms:[],uomsMap:{},loading:!0,search:"",csvFile:null}}componentDidMount(){this.getAllItems(),this.getAllUoms()}async getAllUoms(){const e=(await ee.A.getAllUoms()).data.uom,t=this.fetchMap(e);this.setState({uoms:e,uomsMap:t})}render(){const{items:e,loading:t,search:s,uoms:a,uomsMap:l}=this.state,o=e.filter((e=>{var t;return null===(t=e.itemname)||void 0===t?void 0:t.toLowerCase().includes(s.toLowerCase())}));return t?(0,i.jsx)("div",{className:"w-100 text-center mt-5",children:(0,i.jsx)("div",{className:"spinner-border",role:"status",children:(0,i.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):(0,i.jsxs)("div",{style:{marginTop:"100px"},className:"row mt-80 justify-content-center",children:[(0,i.jsx)("h2",{className:"text-center mb-5",children:"Items Page"}),(0,i.jsxs)("div",{className:"col-md-10",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"row mb-3 align-items-center",children:(0,i.jsxs)("div",{className:" d-flex justify-content-between gap-2",children:[(0,i.jsx)("input",{type:"file",accept:".csv",onChange:this.handleFileChange,className:"form-control w-50"}),(0,i.jsxs)("button",{className:"btn btn-warning  ",onClick:this.handleImportCSV,children:[(0,i.jsx)("span",{className:" bi bi-table "}),(0,i.jsx)("span",{children:" Import From CSV"})]})]})}),(0,i.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,i.jsx)("div",{className:"col-md-4 col-sm-6",children:(0,i.jsx)("input",{type:"text",className:"form-control ",placeholder:"Search Items",value:s,onChange:this.handleSearchChange})}),(0,i.jsxs)("div",{className:"d-flex gap-2 ",children:[(0,i.jsx)("div",{className:"col-md-4 col-sm-6 text-center w-auto",children:(0,i.jsx)(ae,{uoms:a,fetchItems:this.getAllItems})}),(0,i.jsx)("div",{className:"col-md-4 text-md-end text-center mt-2 mt-md-0 w-auto",children:(0,i.jsxs)("button",{className:"btn btn-success w-auto",onClick:this.handleExportCSV,children:[(0,i.jsx)("span",{className:" bi bi-table "}),(0,i.jsx)("span",{children:" Export To CSV"})]})})]})]})]}),(0,i.jsx)(Z,{items:o,uoms:a,uomsMap:l,loading:t,search:s,fetchItems:this.getAllItems})]})]})}}},1457:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(214);class l{static createItem(e){return a.A.post("/item",e)}static getAllItems(){return a.A.get("/items")}static getItemById(e){return a.A.get(`/item/${e}`)}static updateItem(e,t){return a.A.put(`/item/${e}`,t)}static deleteItem(e,t){return a.A.delete(`/item/${e}`,t)}static importFromCSV(e){return a.A.post("/importcsv",e,{headers:{"Content-Type":"multipart/form-data"}})}}},1938:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(214);class l{static createUom(e){return a.A.post("/uom",e)}static getAllUoms(){return a.A.get("/uoms")}static getUomById(e){return a.A.get(`/uom/${e}`)}static updateUom(e,t){return a.A.put(`/uom/${e}`,t)}static deleteUom(e,t){return a.A.delete(`/uom/${e}`,t)}}}}]);
//# sourceMappingURL=754.f7dcd809.chunk.js.map